Attribute VB_Name = "MdlFuncionesGenerales"
Public Function StrToStr(cadena As String, Longitud As Long)
    StrToStr = CStr(Left(Trim(CStr(cadena)), Longitud))
End Function
Public Function StrToInt(cadena As String) As Long
    'On Error GoTo cero:
    StrToInt = CLng(cadena)
'cero:
'    StrToInt = 0
End Function
Public Function StrToFec(cadena As String)
    On Error GoTo cero:
    StrToFec = ConvFecha(cadena)
cero:
    StrToFec = "'NULL'"
End Function
Public Function StrToBool(cadena As String)

End Function
Public Function StrToDbl(cadena As String) As Double
    'On Error GoTo cero:
    StrToDbl = CDbl(cadena)
'cero:
    'StrToDbl = 0
End Function
Public Sub InsertarPaso(terceros As Long, paso As Long)
    If Not EsNulo(terceros) Then
        StrSql = "INSERT INTO paso_ext (pasnro, extnro,extestado, extfecha, extusuario) "
        StrSql = StrSql & "  VALUES( " & paso & " , " & terceros & ",-1," & ConvFecha(Date) & " , '" & Left(usuario, 20) & "')"
        objConn.Execute StrSql, , adExecuteNoRecords
    End If
End Sub
Function TieneIdioma(l_ternro As Long, l_idioma As Long) As Boolean
    Dim rs_sub As New ADODB.Recordset
    StrSql = " SELECT empleado, idinro FROM emp_idi WHERE empleado = " & l_ternro & " and idinro = " & l_idioma
    OpenRecordset StrSql, rs_sub
    If rs_sub.EOF Then
        TieneIdioma = False
    Else
        TieneIdioma = True
    End If
End Function

Public Function TraerCodEstadoCivil(EstCivdesabr As String) As Long
Dim rs_sub As New ADODB.Recordset
Dim Aux_Nro_Estcivil As Long

    Aux_Nro_Estcivil = 0
    If Not EsNulo(EstCivdesabr) Then
        StrSql = " SELECT estcivnro FROM estcivil WHERE upper(estcivdesabr) = '" & Left(UCase(EstCivdesabr), 30) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO estcivil (estcivdesabr) VALUES('"
            StrSql = StrSql & Left(UCase(EstCivdesabr), 30) & "')"
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(estcivnro) AS Maxestcivnro FROM estcivil "
            OpenRecordset StrSql, rs_sub
                
            Aux_Nro_Estcivil = rs_sub!Maxestcivnro
        Else
            Aux_Nro_Estcivil = rs_sub!estcivnro
        End If
    Else
        Aux_Nro_Estcivil = 0
    End If
    TraerCodEstadoCivil = Aux_Nro_Estcivil
    
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function


'Public Function TraerCodEstadoCivil_old(EstCivdesabr As String) as long
'Dim rs_sub As New ADODB.Recordset
'
'    If Not EsNulo(EstCivdesabr) Then
'        Select Case UCase(EstCivdesabr)
'            'Los case son datos cero, sino creo uno nuevo
'            Case "Sin Datos", "NO ESPECIFICADO", "", "N/A"
'                TraerCodEstadoCivil = 1
'            Case "CASADO", "CASADO/A"
'                TraerCodEstadoCivil = 2
'            Case "CONVIVENCIA"
'                TraerCodEstadoCivil = 3
'            Case "DIVORCIADO", "DIVORCIADO/A"
'                TraerCodEstadoCivil = 4
'            Case "SEPARADO", "SEPARADO/A"
'                TraerCodEstadoCivil = 5
'            Case "SEPARADO DE HECHO"
'                TraerCodEstadoCivil = 6
'            Case "SEPARADO LEGAL"
'                TraerCodEstadoCivil = 7
'            Case "SOLTERO", "SOLTERO/A"
'                TraerCodEstadoCivil = 8
'            Case "VIUDO", "VIUDO/A"
'                TraerCodEstadoCivil = 9
'            Case Else
'                StrSql = " SELECT estcivnro FROM estcivil WHERE estcivdesabr = '" & EstCivdesabr & "'"
'                OpenRecordset StrSql, rs_sub
'                If rs_sub.EOF Then
'                    StrSql = "INSERT INTO estcivil (estcivdesabr) VALUES('"
'                    StrSql = StrSql & Left(UCase(EstCivdesabr), 30) & "')"
'                    objConn.Execute StrSql, , adExecuteNoRecords
'
'                    StrSql = " SELECT MAX(estcivnro) AS Maxestcivnro FROM estcivil "
'                    OpenRecordset StrSql, rs_sub
'
'                    TraerCodEstadoCivil = rs_sub!Maxestcivnro
'                Else
'                    TraerCodEstadoCivil = rs_sub!estcivnro
'                End If
'        End Select
'    Else
'        TraerCodEstadoCivil = 1 'Sin datos
'    End If
'
'
'If rs_sub.State = adStateOpen Then rs_sub.Close
'Set rs_sub = Nothing
'End Function


Public Function TraerCodTipoDocumento(Sigla As String)
    If Not EsNulo(Sigla) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT tidnro FROM tipodocu WHERE upper(tidsigla) = '" & UCase(Left(Sigla, 8)) & "' OR upper(tidnom) = '" & UCase(Left(Sigla, 30)) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO tipodocu (tidsigla, tidnom, tidpers, tidsist, instnro,tidunico) VALUES('"
            StrSql = StrSql & Left(Sigla, 8) & "','" & Left(Sigla, 30) & "',0,0,7,0)"
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(tidnro) AS Maxtidnro FROM tipodocu "
            OpenRecordset StrSql, rs_sub
                
            TraerCodTipoDocumento = rs_sub!Maxtidnro
        Else
            TraerCodTipoDocumento = rs_sub!tidnro
        End If
    Else
        'TraerCodTipoDocumento = TraerCodTipoDocumento("dni")
    End If
End Function
Public Function TraerCodLocalidad(Localidad As String)
    If Not EsNulo(Localidad) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT locnro FROM localidad WHERE upper(locdesc) = '" & Left(UCase(Localidad), 30) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO localidad (locdesc) VALUES('"
            StrSql = StrSql & UCase(Left(Localidad, 30)) & "')"
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(locnro) AS Maxlocnro FROM localidad "
            OpenRecordset StrSql, rs_sub
                
            TraerCodLocalidad = rs_sub!Maxlocnro
        Else
            TraerCodLocalidad = rs_sub!locnro
        End If
    Else
        TraerCodLocalidad = 1 'NO INFORMADA
    End If
End Function
Public Function TraerCodProvincia(Provincia As String)
    If Not EsNulo(Provincia) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT provnro FROM Provincia WHERE upper(provdesc) = '" & Left(UCase(Provincia), 20) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO Provincia (provdesc) VALUES('"
            StrSql = StrSql & UCase(Left(Provincia, 20)) & "')"
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(provnro) AS Maxprovnro FROM Provincia "
            OpenRecordset StrSql, rs_sub
                
            TraerCodProvincia = rs_sub!Maxprovnro
        Else
            TraerCodProvincia = rs_sub!provnro
        End If
    Else
        TraerCodProvincia = 1 'no informada
    End If
End Function

Public Function TraerCodPartido(Partido As String) As Long
    If Not EsNulo(Partido) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT partnro FROM Partido WHERE upper(partnom) = '" & Left(UCase(Partido), 30) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO Partido (partnom) VALUES('"
            StrSql = StrSql & UCase(Left(Partido, 30)) & "')"
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(partnro) AS Maxpartnro FROM Partido "
            OpenRecordset StrSql, rs_sub
                
            TraerCodPartido = rs_sub!Maxpartnro
        Else
            TraerCodPartido = rs_sub!partnro
        End If
    Else
        TraerCodPartido = 1 'Sin datos
    End If
End Function


Public Function TraerCodZona(Zona As String, provnro As Long)
    If Not EsNulo(Zona) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT zonanro FROM Zona WHERE upper(zonadesc) = '" & Left(UCase(Zona), 20) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO zona (zonadesc, provnro) VALUES('"
            StrSql = StrSql & Left(Zona, 20) & "'," & provnro & ")"
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(zonanro) AS Maxzonanro FROM zona "
            OpenRecordset StrSql, rs_sub
                
            TraerCodZona = rs_sub!Maxzonanro
        Else
            TraerCodZona = rs_sub!zonanro
        End If
    End If
End Function
Public Function TraerCodPais(Paisdesc As String)
    If Not EsNulo(Paisdesc) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT paisnro FROM Pais WHERE upper(paisdesc) = '" & Left(UCase(Paisdesc), 20) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO Pais (paisdesc) VALUES('"
            StrSql = StrSql & Left(UCase(Paisdesc), 20) & "')"
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(paisnro) AS Maxpaisnro FROM pais "
            OpenRecordset StrSql, rs_sub
                
            TraerCodPais = rs_sub!Maxpaisnro
        Else
            TraerCodPais = rs_sub!paisnro
        End If
    Else
        TraerCodPais = 1
    End If
End Function
Public Function TraerCodNacionalidad(Nacionaldes As String)
    If Not EsNulo(Nacionaldes) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT Nacionalnro FROM Nacionalidad WHERE upper(Nacionaldes) = '" & Left(UCase(Nacionaldes), 20) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO Nacionalidad (Nacionaldes) VALUES('"
            StrSql = StrSql & Left(UCase(Nacionaldes), 20) & "')"
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(Nacionalnro) AS MaxNacionalnro FROM Nacionalidad "
            OpenRecordset StrSql, rs_sub
                
            TraerCodNacionalidad = rs_sub!MaxNacionalnro
        Else
            TraerCodNacionalidad = rs_sub!nacionalnro
        End If
    End If
End Function

Public Function TraerCodNivelEstudio(nivdesc As String)
    If Not EsNulo(nivdesc) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT nivnro FROM nivest WHERE upper(nivdesc) = '" & Left(UCase(nivdesc), 40) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            
            StrSql = " INSERT INTO nivest (nivdesc,nivsist,nivobligatorio,nivestfli) VALUES ("
            StrSql = StrSql & "'" & Left(UCase(nivdesc), 40) & "'" & ",0,0,0 )"
            
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(nivnro) AS Maxnivnro FROM nivest "
            OpenRecordset StrSql, rs_sub
                
            TraerCodNivelEstudio = CLng(rs_sub!Maxnivnro)
        Else
            TraerCodNivelEstudio = CLng(rs_sub!nivnro)
        End If
    End If
End Function
Public Function TraerCodCarrera(Carredudesabr As String)
    If Not EsNulo(Carredudesabr) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT carredunro FROM cap_carr_edu WHERE carredudesabr = '" & Carredudesabr & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO cap_carr_edu (Carredudesabr) "
            StrSql = StrSql & " VALUES('" & Left(UCase(Carredudesabr), 60) & "')"
            
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(carredunro) AS Maxcarredunro FROM cap_carr_edu "
            OpenRecordset StrSql, rs_sub
                
            TraerCodCarrera = CLng(rs_sub!Maxcarredunro)
        Else
            TraerCodCarrera = CLng(rs_sub!carredunro)
        End If
    Else
        TraerCodCarrera = "NULL"
    End If
End Function
Public Function TraerCodCausa(caudes As String)
    If Not EsNulo(caudes) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT caunro FROM causa WHERE upper(caudes) = '" & UCase(Left(caudes, 60)) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO causa (caudes) "
            StrSql = StrSql & " VALUES('" & Left(UCase(caudes), 60) & "')"
            
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(caunro) AS Maxcaunro FROM causa "
            OpenRecordset StrSql, rs_sub
                
            TraerCodCausa = CLng(rs_sub!Maxcaunro)
        Else
            TraerCodCausa = CLng(rs_sub!caunro)
        End If
    End If
End Function
Public Function TraerCodTitulo(Titdesabr As String, nivnro As Long)
    If Not EsNulo(Titdesabr) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT titnro FROM titulo WHERE titdesabr = '" & Left(UCase(Trim(Titdesabr)), 40) & "'"
        'StrSql = StrSql & " AND nivnro = " & nivnro
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO titulo (titdesabr, nivnro ) "
            StrSql = StrSql & " VALUES('" & Left(UCase(Trim(Titdesabr)), 40) & "'," & nivnro & ")"
            
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(titnro) AS Maxtitnro FROM titulo "
            OpenRecordset StrSql, rs_sub
                
            TraerCodTitulo = CLng(rs_sub!Maxtitnro)
        Else
            TraerCodTitulo = CLng(rs_sub!titnro)
        End If
    Else
        TraerCodTitulo = "Null"
    End If
End Function
Public Function TraerCodTituloSolo(Titdesabr As String)
    If Not EsNulo(Titdesabr) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT titnro FROM titulo WHERE titdesabr = '" & Titdesabr & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO titulo (titdesabr) "
            StrSql = StrSql & " VALUES('" & Left(UCase(Titdesabr), 40) & "')"
'            StrSql = "INSERT INTO nivest (titdesabr) "
'            StrSql = StrSql & " VALUES('" & Titdesabr & "')"
            
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(titnro) AS Maxtitnro FROM titulo "
            OpenRecordset StrSql, rs_sub
                
            TraerCodTituloSolo = CLng(rs_sub!Maxtitnro)
        Else
            TraerCodTituloSolo = CLng(rs_sub!titnro)
        End If
    End If
End Function
Public Function TraerCodInstitucion(Instdes As String)
    If Not EsNulo(Instdes) Then
        Dim rs_sub As New ADODB.Recordset
        Dim Arreglo
            Dim cadena As String
            Dim a As Long
            Arreglo = Split(Instdes)
            If UBound(Arreglo) <= 0 Then
                cadena = Left(Trim(Arreglo(a)), 3)
            Else
                For a = 0 To UBound(Arreglo)
                    cadena = cadena & Left(Trim(Arreglo(a)), 1)
                Next a
            End If
        StrSql = " SELECT instnro FROM institucion WHERE instdes = '" & UCase(Instdes) & "'"
        StrSql = StrSql & " OR instabre = '" & UCase(Left(Instdes, 30)) & "'"
        StrSql = StrSql & " OR instabre = '" & UCase(Left(cadena, 30)) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
       
            StrSql = " INSERT INTO institucion (instdes,instabre, instedu) "
            StrSql = StrSql & "  VALUES ('" & Left(UCase(Instdes), 200) & "','" & Left(UCase(cadena), 30) & "',-1)"
            objConn.Execute StrSql, , adExecuteNoRecords
            

            StrSql = " SELECT MAX(instnro) AS Maxinstnro FROM institucion "
            OpenRecordset StrSql, rs_sub

            TraerCodInstitucion = CLng(rs_sub!Maxinstnro)
        Else
            TraerCodInstitucion = CLng(rs_sub!instnro)
        End If
    End If
End Function
Public Function TraerCodInstitucionAbreviada(Instabre As String)
    If Not EsNulo(Instabre) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT instnro FROM institucion WHERE Instabre = '" & UCase(Instabre) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = " INSERT INTO institucion (instdes,instabre, instedu) "
            StrSql = StrSql & "  VALUES ('" & Left(UCase(Instabre), 200) & "','" & Left(UCase(Instabre), 30) & "',-1)"

            objConn.Execute StrSql, , adExecuteNoRecords

            StrSql = " SELECT MAX(instnro) AS Maxinstnro FROM institucion "
            OpenRecordset StrSql, rs_sub

            TraerCodInstitucionAbreviada = CLng(rs_sub!Maxinstnro)
        Else
            TraerCodInstitucionAbreviada = CLng(rs_sub!instnro)
        End If
    Else
        TraerCodInstitucionAbreviada = 7 'NO informada
    End If
End Function

Public Function TraerCodCargo(Cardesabr As String)
    If Not EsNulo(Cardesabr) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT carnro FROM cargo WHERE upper(cardesabr) = '" & UCase(Left(Cardesabr, 50)) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO cargo (cardesabr ) "
            StrSql = StrSql & " VALUES('" & UCase(Left(Cardesabr, 50)) & "')"

            objConn.Execute StrSql, , adExecuteNoRecords

            StrSql = " SELECT MAX(carnro) AS Maxcarnro FROM cargo "
            OpenRecordset StrSql, rs_sub

            TraerCodCargo = CLng(rs_sub!Maxcarnro)
        Else
            TraerCodCargo = CLng(rs_sub!carnro)
        End If
    Else
        StrSql = "INSERT INTO cargo (cardesabr ) "
        StrSql = StrSql & " VALUES('" & Left(Cardesabr, 50) & "')"

        objConn.Execute StrSql, , adExecuteNoRecords

        StrSql = " SELECT MAX(carnro) AS Maxcarnro FROM cargo "
        OpenRecordset StrSql, rs_sub

        TraerCodCargo = CLng(rs_sub!Maxcarnro)
    End If
End Function
Public Function TraerCodTipoCurso(tipcurdesabr As String) As Long
    If Not EsNulo(tipcurdesabr) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT tipcurnro FROM cap_tipocurso WHERE upper(tipcurdesabr) = '" & Left(UCase(tipcurdesabr), 50) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = " INSERT INTO cap_tipocurso (tipcurdesabr) "
            StrSql = StrSql & "  VALUES ('" & Left(UCase(tipcurdesabr), 50) & "')"

            objConn.Execute StrSql, , adExecuteNoRecords

            StrSql = " SELECT MAX(tipcurnro) AS Maxtipcurnro FROM cap_tipocurso "
            OpenRecordset StrSql, rs_sub

            TraerCodTipoCurso = CLng(rs_sub!Maxtipcurnro)
        Else
            TraerCodTipoCurso = CLng(rs_sub!tipcurnro)
        End If
    End If
End Function

Public Function TraerCodCurso(curdesabr As String, tipcurnro As Long) As Long
    If Not EsNulo(curdesabr) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT curnro FROM cap_curso WHERE curdesabr = '" & UCase(curdesabr) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = " INSERT INTO cap_curso (curdesabr,curcodext, tipcurnro) "
            StrSql = StrSql & "  VALUES ('" & Left(UCase(curdesabr), 50) & "','" & Left(UCase(curdesext), 25) & "', " & tipcurnro & " )"

            objConn.Execute StrSql, , adExecuteNoRecords

            StrSql = " SELECT MAX(curnro) AS Maxcurnro FROM cap_curso "
            OpenRecordset StrSql, rs_sub

            TraerCodCurso = CLng(rs_sub!Maxcurnro)
        Else
            TraerCodCurso = CLng(rs_sub!curnro)
        End If
    End If
End Function



'Public Function TraerCodEltoana(eltanadesabr As String, espnro as long)
'    If Not EsNulo(eltanadesabr) Then
'        Dim rs_sub As New ADODB.Recordset
'        StrSql = " SELECT eltananro FROM eltoana WHERE eltanadesabr = '" & Trim(eltanadesabr) & "' and espnro = " & clng(espnro)
'        OpenRecordset StrSql, rs_sub
'        If rs_sub.EOF Then
'            StrSql = "INSERT INTO eltoana (eltanadesabr, espnro ) "
'            StrSql = StrSql & " VALUES('" & Left(Trim(eltanadesabr), 40) & "'," & espnro & ")"
'
'            objConn.Execute StrSql, , adExecuteNoRecords
'
'            StrSql = " SELECT MAX(eltananro) AS Maxeltananro FROM eltoana "
'            OpenRecordset StrSql, rs_sub
'
'            TraerCodEltoana = clng(rs_sub!Maxeltananro)
'        Else
'            TraerCodEltoana = clng(rs_sub!eltananro)
'        End If
'    Else
'        StrSql = "INSERT INTO eltoana (eltanadesabr, espnro ) "
'        StrSql = StrSql & " VALUES('" & Left(Trim(eltanadesabr), 40) & "', " & espnro & ")"
'
'        objConn.Execute StrSql, , adExecuteNoRecords
'
'        StrSql = " SELECT MAX(eltananro) AS Maxeltananro FROM eltoana "
'        OpenRecordset StrSql, rs_sub
'
'        TraerCodEltoana = clng(rs_sub!Maxeltananro)
'    End If
'End Function

Public Function TraerCodEltoana(eltanadesabr As String, espnro As Long)
'Public Function TraerCodEltoana(eltanadesabr As String) as long
    Flog.Writeline Espacios(Tabulador * 2) & "TraerCodEltoana(" & eltanadesabr & ", " & espnro & ")"
    If Not EsNulo(eltanadesabr) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = "SELECT eltananro FROM eltoana WHERE upper(eltanadesabr) = '" & UCase(Left(Trim(eltanadesabr), 40)) & "' and espnro = " & CLng(espnro)
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO eltoana (eltanadesabr, espnro ) "
            StrSql = StrSql & " VALUES('" & UCase(Left(Trim(eltanadesabr), 40)) & "'," & CLng(espnro) & ")"
            objConn.Execute StrSql, , adExecuteNoRecords

            StrSql = " SELECT MAX(eltananro) AS Maxeltananro FROM eltoana "
            OpenRecordset StrSql, rs_sub

            TraerCodEltoana = CLng(rs_sub!Maxeltananro)
        Else
            TraerCodEltoana = CLng(rs_sub!eltananro)
        End If
    Else
        Flog.Writeline Espacios(Tabulador * 2) & "eltanadesabr NULA. Busco eltoana"
        StrSql = "INSERT INTO eltoana (eltanadesabr, espnro ) "
        StrSql = StrSql & " VALUES('" & Left(Trim(eltanadesabr), 40) & "', " & espnro & ")"

        objConn.Execute StrSql, , adExecuteNoRecords

        StrSql = " SELECT MAX(eltananro) AS Maxeltananro FROM eltoana "
        OpenRecordset StrSql, rs_sub

        TraerCodEltoana = CLng(rs_sub!Maxeltananro)
    End If
End Function

Public Function TraerEspecializacion(espdesabr As String)
    If Not EsNulo(espdesabr) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT espnro FROM especializacion WHERE espdesabr = '" & espdesabr & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO especializacion (espdesabr) "
            StrSql = StrSql & " VALUES('" & Left(espdesabr, 40) & "')"
            
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(espnro) AS Maxespnro FROM especializacion "
            OpenRecordset StrSql, rs_sub
                
            TraerEspecializacion = CLng(rs_sub!Maxespnro)
        Else
            TraerEspecializacion = CLng(rs_sub!espnro)
        End If
    End If
End Function


Public Function TraerCodNivelEspecializacion(espnivdesabr As String)
    If Not EsNulo(espnivdesabr) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT espnivnro FROM espnivel WHERE upper(espnivdesabr) = '" & Left(UCase(espnivdesabr), 40) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO espnivel (espnivdesabr) "
            StrSql = StrSql & " VALUES('" & UCase(Left(espnivdesabr, 40)) & "')"
            
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(espnivnro) AS Maxespnivnro FROM espnivel "
            OpenRecordset StrSql, rs_sub
                
            TraerCodNivelEspecializacion = CLng(rs_sub!Maxespnivnro)
        Else
            TraerCodNivelEspecializacion = CLng(rs_sub!espnivnro)
        End If
    End If
End Function
Public Function TraerCodEspecializacion(espdesabr As String)
    If Not EsNulo(espdesabr) Then
        Flog.Writeline Espacios(Tabulador * 2) & "Especializacion: " & espdesabr
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT espnro FROM especializacion WHERE espdesabr = '" & espdesabr & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO especializacion (espdesabr) "
            StrSql = StrSql & " VALUES('" & Left(espdesabr, 40) & "')"
            
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(espnro) AS Maxespnro FROM especializacion "
            OpenRecordset StrSql, rs_sub
                
            TraerCodEspecializacion = CLng(rs_sub!Maxespnro)
        Else
            TraerCodEspecializacion = CLng(rs_sub!espnro)
        End If
    Else
        Flog.Writeline Espacios(Tabulador * 2) & "Especializacion NULA"
    End If
End Function
Public Function TraerCodProcedencia(Prodesabr As String)
    If Not EsNulo(Trim(Left(Prodesabr, 30))) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT pronro FROM pos_procedencia WHERE upper(prodesabr) = '" & UCase(Trim(Left(Prodesabr, 30))) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO pos_procedencia (prodesabr) "
            StrSql = StrSql & " VALUES('" & UCase(Trim(Left(Prodesabr, 30))) & "')"
            
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(pronro) AS Maxpronro FROM pos_procedencia "
            OpenRecordset StrSql, rs_sub
                
            TraerCodProcedencia = CLng(rs_sub!Maxpronro)
        Else
            TraerCodProcedencia = CLng(rs_sub!pronro)
        End If
    End If
End Function

Public Function TraerCodListaEmpresa(lempdes As String)
    lempdes = Left(lempdes, 60)
    If Not EsNulo(lempdes) Then
        Dim Rs_Estr As New ADODB.Recordset
        StrSql = " SELECT lempnro FROM listaemp WHERE upper(lempdes) = '" & UCase(Left(lempdes, 60)) & "'"
        OpenRecordset StrSql, Rs_Estr
        If Not Rs_Estr.EOF Then
            TraerCodListaEmpresa = CLng(Rs_Estr!lempnro)
        Else
            StrSql = " INSERT INTO listaemp(lempdes)"
            StrSql = StrSql & " VALUES('" & Left(UCase(lempdes), 60) & "')"
            objConn.Execute StrSql, , adExecuteNoRecords
            StrSql = " SELECT MAX(lempnro) AS MaxEmpnro FROM listaemp "
            OpenRecordset StrSql, Rs_Estr
            
            TraerCodListaEmpresa = CLng(Rs_Estr!MaxEmpnro)
        End If
    Else
        TraerCodListaEmpresa = 0
    End If
End Function
Public Function TraerCodIdioma(ididesc As String)
    If Not EsNulo(ididesc) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT idinro FROM Idioma WHERE upper(ididesc) = '" & UCase(Left(ididesc, 30)) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO idioma (ididesc) "
            StrSql = StrSql & " VALUES('" & UCase(Left(ididesc, 30)) & "')"
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(idinro) AS Maxidinro FROM idioma "
            OpenRecordset StrSql, rs_sub
                
            TraerCodIdioma = CLng(rs_sub!Maxidinro)
        Else
            TraerCodIdioma = CLng(rs_sub!idinro)
        End If
    End If
End Function
Public Function TraerCodIdiNivel(idnivdesabr As String)
    If Not EsNulo(idnivdesabr) Then
        Dim rs_sub As New ADODB.Recordset
        StrSql = " SELECT idnivnro FROM idinivel WHERE upper(idnivdesabr) = '" & UCase(Left(idnivdesabr, 30)) & "'"
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            StrSql = "INSERT INTO idinivel (idnivdesabr,idnivvalor) "
            StrSql = StrSql & " VALUES('" & UCase(Left(idnivdesabr, 30)) & "',0)"
            objConn.Execute StrSql, , adExecuteNoRecords
            
            StrSql = " SELECT MAX(idnivnro) AS Maxidnivnro FROM idinivel "
            OpenRecordset StrSql, rs_sub
                
            TraerCodIdiNivel = CLng(rs_sub!Maxidnivnro)
        Else
            TraerCodIdiNivel = CLng(rs_sub!idnivnro)
        End If
    End If
End Function

Function validatelefono(cadena As String)
    Dim a As Long
    Dim car As String
    Dim cadenacompleta As String
    For a = 1 To Len(cadena)
        car = Asc(Mid(cadena, a, 1))
        If (car > 47 And car < 58) Or (car > 39 And car < 43) Or (car = 45) Or (car = 32) Or (car = 35) Then
            cadenacompleta = CStr(cadenacompleta) & CStr(Chr(car))
        End If
    Next a
    validatelefono = cadenacompleta
End Function

' ---------------------------------------------------------------------------------------------
' ---------------------------------------------------------------------------------------------
' ---------------------------------------------------------------------------------------------

Public Function TraerCodTipoDocumento_2(Sigla As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Sigla) Then
        StrSql = " SELECT tidnro FROM tipodocu WHERE tidnro = " & Sigla
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodTipoDocumento_2 = 0
        Else
            TraerCodTipoDocumento_2 = rs_sub!tidnro
        End If
    Else
        TraerCodTipoDocumento_2 = 0
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function


Public Function TraerCodNacionalidad_2(Nacionaldes As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Nacionaldes) Then
        StrSql = " SELECT Nacionalnro FROM Nacionalidad WHERE Nacionalnro = " & Nacionaldes
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodNacionalidad_2 = 0
        Else
            TraerCodNacionalidad_2 = rs_sub!nacionalnro
        End If
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodEstadoCivil_2(EstCivdesabr As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
Dim Aux_Nro_Estcivil As Long

    Aux_Nro_Estcivil = 0
    If Not EsNulo(EstCivdesabr) Then
        StrSql = " SELECT estcivnro FROM estcivil WHERE estcivnro = " & EstCivdesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            Aux_Nro_Estcivil = 0
        Else
            Aux_Nro_Estcivil = rs_sub!estcivnro
        End If
    Else
        Aux_Nro_Estcivil = 0
    End If
    TraerCodEstadoCivil_2 = Aux_Nro_Estcivil
    
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function


Public Function TraerCodPais_2(Paisdesc As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Paisdesc) Then
        StrSql = " SELECT paisnro FROM Pais WHERE paisnro = " & Paisdesc
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodPais_2 = 1
        Else
            TraerCodPais_2 = rs_sub!paisnro
        End If
    Else
        TraerCodPais_2 = 1
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function


Public Function TraerCodLocalidad_2(Localidad As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Localidad) Then
        StrSql = " SELECT locnro FROM localidad WHERE locnro = " & Localidad
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodLocalidad_2 = 1
        Else
            TraerCodLocalidad_2 = rs_sub!locnro
        End If
    Else
        TraerCodLocalidad_2 = 1 'NO INFORMADA
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodProvincia_2(Provincia As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Provincia) Then
        StrSql = " SELECT provnro FROM Provincia WHERE provnro = " & Provincia
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodProvincia_2 = 1 'no informada
        Else
            TraerCodProvincia_2 = rs_sub!provnro
        End If
    Else
        TraerCodProvincia_2 = 1 'no informada
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function


Public Function TraerCodPartido_2(Partido As String) As Long
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Partido) Then
        StrSql = " SELECT partnro FROM Partido WHERE partnro = " & Partido
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodPartido_2 = 1
        Else
            TraerCodPartido_2 = rs_sub!partnro
        End If
    Else
        TraerCodPartido_2 = 1 'Sin datos
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function


Public Function TraerCodZona_2(Zona As String, provnro As Long)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Zona) Then
        StrSql = " SELECT zonanro FROM Zona WHERE zonanro = " & Zona
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodZona_2 = 0
        Else
            TraerCodZona_2 = rs_sub!zonanro
        End If
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodProcedencia_2(Prodesabr As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Trim(Left(Prodesabr, 30))) Then
        StrSql = " SELECT pronro FROM pos_procedencia WHERE pronro = " & Prodesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodProcedencia_2 = 0
        Else
            TraerCodProcedencia_2 = CLng(rs_sub!pronro)
        End If
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function






Public Function TraerCodNivelEstudio_2(nivdesc As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    
    If Not EsNulo(nivdesc) Then
        StrSql = " SELECT nivnro FROM nivest WHERE nivnro = " & nivdesc
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodNivelEstudio_2 = 0
        Else
            TraerCodNivelEstudio_2 = CLng(rs_sub!nivnro)
        End If
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodCarrera_2(Carredudesabr As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset

    If Not EsNulo(Carredudesabr) Then
        StrSql = " SELECT carredunro FROM cap_carr_edu WHERE carredunro = " & Carredudesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodCarrera_2 = "NULL"
        Else
            TraerCodCarrera_2 = CLng(rs_sub!carredunro)
        End If
    Else
        TraerCodCarrera_2 = "NULL"
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodCausa_2(caudes As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    
    If Not EsNulo(caudes) Then
        StrSql = " SELECT caunro FROM causa WHERE caunro = " & caudes
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodCausa_2 = 0
        Else
            TraerCodCausa_2 = CLng(rs_sub!caunro)
        End If
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodTitulo_2(Titdesabr As String, nivnro As Long)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Titdesabr) Then
        StrSql = " SELECT titnro FROM titulo WHERE titnro = " & Titdesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodTitulo_2 = "Null"
        Else
            TraerCodTitulo_2 = CLng(rs_sub!titnro)
        End If
    Else
        TraerCodTitulo_2 = "Null"
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodTituloSolo_2(Titdesabr As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Titdesabr) Then
        StrSql = " SELECT titnro FROM titulo WHERE titnro = " & Titdesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodTituloSolo_2 = 0
        Else
            TraerCodTituloSolo_2 = CLng(rs_sub!titnro)
        End If
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodInstitucion_2(Instdes As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
Dim Arreglo
Dim cadena As String
Dim a As Long
    
    TraerCodInstitucion_2 = 0
    
    If Not EsNulo(Instdes) Then
        StrSql = " SELECT instnro FROM institucion WHERE instnro = " & Instdes
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodInstitucion_2 = 0
        Else
            TraerCodInstitucion_2 = CLng(rs_sub!instnro)
        End If
    End If
    
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodInstitucionAbreviada_2(Instabre As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(Instabre) Then
        StrSql = " SELECT instnro FROM institucion WHERE instnro = " & Instabre
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodInstitucionAbreviada_2 = 7
        Else
            TraerCodInstitucionAbreviada_2 = CLng(rs_sub!instnro)
        End If
    Else
        TraerCodInstitucionAbreviada_2 = 7 'NO informada
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodCargo_2(Cardesabr As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset

    If Not EsNulo(Cardesabr) Then
        StrSql = " SELECT carnro FROM cargo WHERE carnro = " & Cardesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodCargo_2 = 0
        Else
            TraerCodCargo_2 = CLng(rs_sub!carnro)
        End If
    Else
        TraerCodCargo_2 = 0
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodTipoCurso_2(tipcurdesabr As String) As Long
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset

    TraerCodTipoCurso_2 = 0
    
    If Not EsNulo(tipcurdesabr) Then
        StrSql = " SELECT tipcurnro FROM cap_tipocurso WHERE tipcurnro = " & tipcurdesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodTipoCurso_2 = 0
        Else
            TraerCodTipoCurso_2 = CLng(rs_sub!tipcurnro)
        End If
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodCurso_2(curdesabr As String, tipcurnro As Long) As Long
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    If Not EsNulo(curdesabr) Then
        StrSql = " SELECT curnro FROM cap_curso WHERE curnro = " & curdesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodCurso_2 = 0
        Else
            TraerCodCurso_2 = CLng(rs_sub!curnro)
        End If
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function


Public Function TraerCodListaEmpresa_2(lempdes As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim Rs_Estr As New ADODB.Recordset

    lempdes = Left(lempdes, 60)
    If Not EsNulo(lempdes) Then
        StrSql = " SELECT lempnro FROM listaemp WHERE lempnro = " & lempdes
        OpenRecordset StrSql, Rs_Estr
        If Not Rs_Estr.EOF Then
            TraerCodListaEmpresa_2 = CLng(Rs_Estr!lempnro)
        Else
            TraerCodListaEmpresa_2 = 0
        End If
    Else
        TraerCodListaEmpresa_2 = 0
    End If
If Rs_Estr.State = adStateOpen Then Rs_Estr.Close
Set Rs_Estr = Nothing
End Function

Public Function TraerCodIdioma_2(ididesc As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset

    If Not EsNulo(ididesc) Then
        StrSql = " SELECT idinro FROM Idioma WHERE idinro = " & ididesc
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodIdioma_2 = 0
        Else
            TraerCodIdioma_2 = CLng(rs_sub!idinro)
        End If
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodIdiNivel_2(idnivdesabr As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    
    If Not EsNulo(idnivdesabr) Then
        StrSql = " SELECT idnivnro FROM idinivel WHERE idnivnro = " & idnivdesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodIdiNivel_2 = 0
        Else
            TraerCodIdiNivel_2 = CLng(rs_sub!idnivnro)
        End If
    Else
        TraerCodIdiNivel_2 = 0
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodEspecializacion_2(espdesabr As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    
    If Not EsNulo(espdesabr) Then
        Flog.Writeline Espacios(Tabulador * 2) & "Especializacion: " & espdesabr
        StrSql = " SELECT espnro FROM especializacion WHERE espnro = " & espdesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodEspecializacion_2 = 0
        Else
            TraerCodEspecializacion_2 = CLng(rs_sub!espnro)
        End If
    Else
        Flog.Writeline Espacios(Tabulador * 2) & "Especializacion NULA"
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

Public Function TraerCodNivelEspecializacion_2(espnivdesabr As String)
' ---------------------------------------------------------------------------------------------
' Descripcion: Customizacion de la Funcion.
' Autor      : FGZ
' Fecha      : 02/09/2005
' Ultima Mod.:
' Descripcion:
' ---------------------------------------------------------------------------------------------
Dim rs_sub As New ADODB.Recordset
    
    If Not EsNulo(espnivdesabr) Then
        StrSql = " SELECT espnivnro FROM espnivel WHERE espnivnro = " & espnivdesabr
        OpenRecordset StrSql, rs_sub
        If rs_sub.EOF Then
            TraerCodNivelEspecializacion_2 = 0
        Else
            TraerCodNivelEspecializacion_2 = CLng(rs_sub!espnivnro)
        End If
    End If
If rs_sub.State = adStateOpen Then rs_sub.Close
Set rs_sub = Nothing
End Function

